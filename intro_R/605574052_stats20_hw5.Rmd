---
title: "Stats 20, S22A -- Homework 5"
author: "Jun Ryu -- 605574052"
date: "`r format(Sys.Date(), '%D')`"
output:
  html_document:
    toc: yes            # creates table of contents
    toc_depth: 4        # toc will include headers <= ####
    toc_float: yes      # toc always on left of page
    code_folding: show  # allows hiding of code
---

## Question 1

### (a)

```{r}
keep_words <- function(words) {
  words[nchar(words) > 0]
}

is_special_ending <- function(ending) {
  is_es <- all(ending == c("e", "s"))
  is_ed <- all(ending == c("e", "d"))
  is_e_not_le <- ending[2] == "e" & ending[1] != "l"
  is_es | is_ed | is_e_not_le
}

rm_special_endings <- function(word_letters) {
  word_tail <- tail(word_letters, n = 2)
  if (is_special_ending(word_tail)) {
    if (word_tail[2] == "e") {
      word_letters[-length(word_letters)]
    } else {
      head(word_letters, n = -2)
    }
  } else {
    word_letters
  }
}

is_vowel <- function(letter) {
  letter %in% c("a", "e", "i", "o", "u", "y")
}

count_syllables <- function(word) {
  word_letters <- unlist(strsplit(word, split = ""))
  if (length(word_letters) <= 3) {
    1
  } else {
    word_letters <- rm_special_endings(word_letters)
    word_vowels <- is_vowel(word_letters)
    sum(word_vowels) - sum(diff(which(word_vowels)) == 1)
  }
}

reading_ease <- function(s) {
  s <- paste(s, collapse = " ")
  sentence_count <- length(gsub(pattern = "[[:punct:]]", replacement = "", tolower(strsplit(s, split = "[.!?:;]")[[1]])))
  
  word_count <- length(lapply(strsplit(s, split = " "), keep_words)[[1]])
  
  word_list <- gsub(pattern = "[[:punct:]]", replacement = "", lapply(strsplit(s, split = " "), keep_words)[[1]])
  
  syllable_count <- numeric(1)
  for (i in 1:length(word_list)) {
    syllable_count <- syllable_count + count_syllables(word_list[i])
  }
    
  score <- 206.835 - (1.015*word_count/sentence_count) - (84.6*syllable_count/word_count)
  score
}

```

### (b)

```{r}

waffles_vec <- c("We need to remember what's important in life: friends, waffles, work.", "Or waffles, friends, work.", "Doesn't matter, but work is third.")

reading_ease(waffles_vec)

```

## Question 2

```{r}

my_nchar <- function(x) {
  result <- logical(0)
  for (i in 1:length(x)) {
    result <- c(result, length(unlist(strsplit(as.character(x[i]), split = ""))))
  }
  result
}

```


## Question 3

```{r}

my_strrep <- function(x, times) {
  result <- logical(0)
  for (i in 1:length(x)) {
    result <- c(result, paste(rep(x[i],times), collapse = ""))
  }
  result
}

```

## Question 4

### (a)

```{r}
births <- read.csv("births.csv", stringsAsFactors = TRUE)
```

### (b)

```{r}

table(births$Habit)
```

There are 6 observations that do not have the information about the mother's smoking status. These observations are not labeled with anything.

### (c)

```{r}

barplot(table(births$Habit), col = c("pink","light blue","orange"))
```

### (d)

```{r}

births_new <- births[which(births$Habit != ""),]
births_new$Habit <- droplevels(births_new$Habit)

```

### (e)

```{r}

boxplot(births_new$weight ~ births_new$Habit)
```


## Question 5

```{r}

with(births_new, hist(weight[Habit == "Smoker"], prob = TRUE, density = 20, col = "red", xlab = "Weight (in pounds)", main = "Histogram of Weight by Smoking Status", xlim = c(0,200), ylim = c(0,0.03)))
with(births_new, lines(density(weight[Habit == "Smoker"]), lwd = 2, col = "red"))
with(births_new, abline(v = summary(weight[Habit == "Smoker"])[3], lty = 2, col = "red"))

with(births_new, hist(weight[Habit == "NonSmoker"], prob = TRUE, density = 30, col = "blue", add = TRUE))
with(births_new, lines(density(weight[Habit == "NonSmoker"]), lwd = 2, col = "blue"))
with(births_new, abline(v = summary(weight[Habit == "NonSmoker"])[3], lty = 2, col = "blue"))

legend("topleft", c("Smoker", "Non-Smoker"), density = c(20,30), fill = c("red", "blue"), inset = 0.03)

```


## Question 6

### (a)

```{r}

library(ggplot2)
data(diamonds)
pairs(diamonds[c(1, 5:7)])

```

Carat and price seem to have the strongest correlation between them and the correlation seems mostly linear.

### (b)

```{r}

with(diamonds, plot(price ~ carat, pch = 5, cex = 0.15, col = clarity))
with(diamonds, legend("bottomright", legend = levels(clarity), pch = 5, col = 1:8))

```

### (c)

```{r}

with(diamonds, plot(price ~ carat, pch = 5, cex = 0.15, col = c("deepskyblue1", "deepskyblue2", "deepskyblue3", "deepskyblue4", "dodgerblue1", "dodgerblue2", "dodgerblue3", "dodgerblue4")[clarity]))
with(diamonds, legend("bottomright", legend = levels(clarity), pch = 5, col = c("deepskyblue1", "deepskyblue2", "deepskyblue3", "deepskyblue4", "dodgerblue1", "dodgerblue2", "dodgerblue3", "dodgerblue4")))

```

### (d)

A diamond is more likely to be more expensive if it is of higher carat and has a higher clarity.

## Question 7

### (a)

```{r}

color_cut <- with(diamonds, tapply(price, list(color, cut), mean))
color_cut

```

### (b)
```{r}

matplot(color_cut, type = "l", lty = 1:5, lwd = 1:5, col = c("red","orange","yellow","green","blue"), xaxt = "n", xlab = "color", ylab = "price (in dollars)")
with(diamonds, axis(1, at = 1:7, labels = levels(color)))
with(diamonds, legend("topleft", legend = levels(cut), lty = 1:5, lwd = 1:5, col = c("red","orange","yellow","green","blue")))

```

### (c)

In terms of cuts, premium cuts tend to result in the higher prices while ideal cuts prove the opposite. In terms of colors, as the level of color goes up, the price tends to go up as well.


## Question 8

```{r}

`%is_in%` <- function(x, table) {
  result <- logical(length(x))
  for (i in 1:length(x)) {
    for (j in 1:length(table)) {
      if (x[i] == table[j]) {
        result[i] <- TRUE
        break
      } else {
        result[i] <- FALSE
      }
    }
  }
  result
}

```



