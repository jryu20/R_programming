---
title: "Homework 7"
author: 'Jun Ryu, UID: 605574052'
date: "2023-05-19"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
```

## Question 1

```{r}
waist <- read.table("waistweightheight.txt", header = T)
head(waist)
```

### a)

```{r}
model <- lm(Weight~Waist+Height, data = waist)
```

#### i)

```{r}
summary(model)
anova(model)
```

Looking at the ANOVA table, SSReg is $358074 + 29843$, which is 387917. RSS is 50259, and SYY is the sum of SSReg and RSS, which is $387917 + 50259$ or 438176.

#### ii)

From the summary table, the R-squared value is 0.8853 and the adjusted R-squared value is 0.8848.

#### iii)

From the summary table, the slope for the height is 2.4884, which indicates that among people of the same waist size, people whose height is 1 inch taller are on average 2.4884 pounds heavier.

### b)

```{r}
set.seed(23)
new.df <- transform(waist, worthless = rnorm(dim(waist)[1],0,5))
model2 <- lm(Weight~Waist+Height+worthless, data = new.df)
summary(model2)
anova(model2)
```

#### i)

Looking at the ANOVA table, SSReg is $358074 + 29843 + 12$, which is 387929. RSS is 50247, and SYY is the sum of SSReg and RSS, which is $387929 + 50247$ or 438176.

#### ii)

The SYY has stayed the same, but SSReg has gone up due to the addition of a new variable, while the RSS has gone down.

#### iii)

The R-squared value has remained the same, but the adjusted R-squared value has gone down from the previous model.

### c)

```{r}
model3 <- lm(Weight~worthless+Waist+Height, data = new.df)
summary(model3)
anova(model3)
```

From part b), we first notice that both the R-squared and the adjusted R-squared values remain the same. Also, our RSS value has remained the same at 50247, but our SSReg value has changed by 1 giving us a value of 387928 instead. 

### d)

Adjusted R-squared value is a better indicator at telling us whether we should add a new variable because the R-squared value will always go up if you add a new variable, whereas the adjusted R-squared value can go either direction and indicate how useful the added variable is based on which direction it goes.

### e)

Looking at SSReg is not as effective because adding a new variable will most likely make the value go up regardless of its significance. Instead, partial tests are better since looking at values like the p-value tells us more concretely whether the new variable is statistically significant or not (e.g. less than 0.05).

## Question 2

```{r}
cars <- read.csv("cars04.csv")
head(cars)
model_car <- lm(SuggestedRetailPrice ~ DealerCost+EngineSize+Horsepower+CityMPG+
                  HighwayMPG+Weight+WheelBase+Length+Width+Cylinders, data = cars)
```

### a)

If we were to include the column Vehicle.Name, since the column entries are not of a numeric type, it will categorize each vehicle name as its own variable, and that is certainly not what we want.

### b)

```{r}
summary(model_car)
```

The equation of the fitted model is SuggestedRetailPrice = 349.97628 + 1.05418\*DealerCost - 32.2472\*EngineSize + 2.36212\*Horsepower - 16.74239\*CityMPG + 46.75754\*HighwayMPG + 0.6992\*Weight + 27.05345\*WheelBase - 7.32019\*Length - 84.70850\*Width + 228.32592\*Cylinders

### c)

For the Cylinders variable, the estimated slope is 228.32592. The t-statistic is 3.171 and the p-value is 0.00173. From these last two values, we can conclude that Cylinders is a useful predictor (by itself) in predicting the SuggestedRetailPrice.

### d)

```{r}
anova(model_car)
```

You can get the t-statistics by simply taking the square root of the F-values shown in the ANOVA table (since Cylinders is placed last meaning that all other variables are controlled for both values).

### e)

Using the summary command, we obtain the F-value for Cylinders by simply squaring the value. The F-value represents whether Cylinders is statistically significant given that all other variables are controlled and included in the model.

### f)

```{r}
model_reduced <- lm(SuggestedRetailPrice ~ DealerCost+EngineSize+Horsepower+Weight+
                      WheelBase+Length+Width+Cylinders, data = cars)
anova(model_car, model_reduced)
```

Since our p-value is less than 0.05 (0.02165), we can reject the null hypothesis that fuel consumption has no affect on the suggested retail price. 































































